<div class="flex w-full justify-between">
  <xng-breadcrumb></xng-breadcrumb>
</div>
<hr class="mb-6 mt-2 h-[2px] w-full bg-neutral-300" />
<div class="flex gap-2">
  <div
    class="item-center min-w-1/5 flex basis-1/5 justify-between rounded border border-neutral-200 bg-white"
  >
    <div class="flex grow flex-col">
      <div class="flex flex-col p-6">
        <h1 class="text-2xl text-black">Previous Versions</h1>
      </div>
      <ul
        class="flex max-h-[80vh] w-full grow flex-col gap-3 overflow-y-auto bg-neutral-100 p-3"
      >
        <li>
          <a
            class="block rounded bg-green-500 px-2 py-1 text-white hover:bg-green-700"
            (click)="retrieveFile()"
          >
            <h1 class="text-xl">Template File</h1>
          </a>
        </li>
        <ng-container *ngIf="documents">
          <li *ngFor="let row of documents.documents">
            <a
              class="block rounded bg-white px-2 py-1 hover:bg-neutral-200"
              (click)="retrieveSubmittedFile(row.version)"
            >
              <h1 class="text-xl">
                {{ row.documentName }} - ver.{{ row.version }}
              </h1>
              <p class="text-xs text-neutral-500">
                Start Date: {{ row.startDate | date: 'YYYY-MM-dd' }}
              </p>
              <p class="text-xs text-neutral-500">
                End Date: {{ row.endDate | date: 'YYYY-MM-dd' }}
              </p>
              <p class="text-xs text-neutral-500">
                Hours Rendered: {{ row.hours ?? 0 }}hrs
              </p>
            </a>
          </li>
        </ng-container>
      </ul>
    </div>
  </div>
  <form
    class="flex grow flex-col"
    (submit)="uploadFile()"
    [formGroup]="timeForm"
  >
    <div
      class="border-netural-200 flex items-center justify-between rounded-t border bg-white p-6"
    >
      <div class="flex items-center gap-5" *ngIf="matchPhase">
        <div
          class="min-w-1/3 tems-center flex items-center justify-center gap-2"
        >
          <label
            for="startDate"
            class="block min-w-fit text-sm font-medium text-gray-900 dark:text-white"
            >Start Date:</label
          >
          <div class="relative">
            <div
              class="pointer-events-none absolute inset-y-0 start-0 flex items-center ps-3"
            >
              <svg
                class="h-4 w-4 text-gray-500 dark:text-gray-400"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"
                />
              </svg>
            </div>

            <input
              formControlName="startDate"
              divControlName="startDate"
              placeholder="Date"
              type="date"
              class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 ps-10 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500"
              placeholder="Select date start"
              [max]="timeForm.get('endDate')?.value"
            />
          </div>
        </div>
        <div
          class="min-w-1/3 tems-center flex items-center justify-center gap-2"
        >
          <label
            for="endDate"
            class="block min-w-fit text-sm font-medium text-gray-900 dark:text-white"
            >End Date:</label
          >
          <div class="relative">
            <div
              class="pointer-events-none absolute inset-y-0 start-0 flex items-center ps-3"
            >
              <svg
                class="h-4 w-4 text-gray-500 dark:text-gray-400"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"
                />
              </svg>
            </div>
            <input
              formControlName="endDate"
              divControlName="endDate"
              placeholder="Date"
              type="date"
              class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 ps-10 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500"
              placeholder="Select date start"
              [min]="timeForm.get('startDate')?.value"
            />
          </div>
        </div>
      </div>
      <div
        class="min-w-1/3 tems-center flex items-center justify-center gap-2"
        *ngIf="matchPhase"
      >
        <label
          class="block min-w-fit text-sm font-medium text-gray-900 dark:text-white"
          for="file_input"
          >Upload file</label
        >
        <input
          id="file_input"
          type="file"
          (change)="onFileSelected($event)"
          accept=".pdf"
          class="hidden"
          class="block w-full cursor-pointer rounded-lg border border-gray-300 bg-gray-50 text-sm text-gray-900 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 dark:placeholder-gray-400"
        />
      </div>
    </div>
    <ngx-extended-pdf-viewer
      [src]="pdfSrc"
      [height]="'auto'"
      [textLayer]="true"
      [showHandToolButton]="true"
    >
    </ngx-extended-pdf-viewer>

    <div
      class="flex justify-between rounded-b border border-neutral-200 bg-white p-6"
      *ngIf="matchPhase"
    >
      <div class="min-w-1/3 tems-center flex items-center justify-center gap-2">
        <label
          for="endDate"
          class="block min-w-fit text-sm font-medium text-gray-900 dark:text-white"
          >Hours Rendered:</label
        >
        <input
          formControlName="hoursRendered"
          min="0"
          divControlName="hoursRendered"
          placeholder="Hours"
          type="number"
          class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500"
        />
      </div>
      <button
        class="rounded bg-lime-600 px-6 py-3 text-center text-white hover:bg-lime-700"
        type="submit"
      >
        Save
      </button>
    </div>
  </form>
</div>
