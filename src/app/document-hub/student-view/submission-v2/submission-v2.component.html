<div class="flex w-full justify-between">
  <xng-breadcrumb></xng-breadcrumb>
</div>
<hr class="mb-6 mt-2 h-[2px] w-full bg-neutral-300" />
<div class="flex gap-2">
  <div
    class="item-center min-w-1/5 flex basis-1/5 justify-between rounded border border-neutral-200 bg-white"
  >
    <div class="flex grow flex-col">
      <div class="flex flex-col p-6">
        <h1 class="text-2xl text-black">Previous Versions</h1>
      </div>
      <ul
        class="flex max-h-[80vh] w-full grow flex-col gap-3 overflow-y-auto bg-neutral-100 p-3"
      >
        <li>
          <a
            class="block rounded bg-green-500 px-2 py-1 text-white hover:bg-green-700"
            (click)="retrieveFile()"
          >
            <h1 class="text-xl">Template File</h1>
          </a>
        </li>
        <ng-container *ngIf="documents">
          <li *ngFor="let row of documents.documents">
            <a
              class="block rounded bg-white px-2 py-1 hover:bg-neutral-200"
              (click)="retrieveSubmittedFile(row.version)"
            >
              <h1 class="text-xl">
                {{ row.documentName }} - ver.{{ row.version }}
              </h1>
              <p class="text-xs text-neutral-500">
                {{ row.dateCreated | date: 'YYYY-MM-dd' }}
              </p>
            </a>
          </li>
        </ng-container>
      </ul>
    </div>
  </div>

  <div class="flex grow flex-col">
    <div
      class="flex items-center justify-between rounded-t border border-neutral-200 bg-white p-6"
    >
      <div class="flex flex-col">
        <h1 class="text-2xl text-black">
          {{ docuName }} -
          {{ currentVersion != undefined ? 'v.' + currentVersion : 'template' }}
        </h1>
      </div>
      <div
        class="min-w-1/3 tems-center flex items-center justify-center gap-2"
        *ngIf="!isApproved && matchPhase"
      >
        <label
          class="block min-w-fit text-sm font-medium text-gray-900 dark:text-white"
          for="file_input"
          >Upload file</label
        >
        <input
          id="file_input"
          type="file"
          (change)="onFileSelected($event)"
          accept=".pdf"
          class="hidden"
          class="block w-full cursor-pointer rounded-lg border border-gray-300 bg-gray-50 text-sm text-gray-900 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 dark:placeholder-gray-400"
        />
      </div>
    </div>
    <ngx-extended-pdf-viewer
      [src]="pdfSrc"
      [height]="'auto'"
      [textLayer]="true"
      [showHandToolButton]="true"
    >
    </ngx-extended-pdf-viewer>
    <div
      *ngIf="documents?.nextVersion"
      class="flex flex-col justify-between gap-4 border border-t-0 border-neutral-200 bg-white p-6"
    >
      <h1 class="text-xl text-black">Feedback</h1>
      <p class="pl-6">
        {{ feedback === '' || feedback == null ? 'No Feedback Yet' : feedback }}
      </p>
    </div>

    <div
      class="flex justify-end rounded-b border border-neutral-200 bg-white p-6"
      *ngIf="!isApproved && matchPhase"
    >
      <button
        class="rounded bg-lime-600 px-6 py-3 text-center text-white hover:bg-lime-700"
        (click)="uploadFile()"
      >
        Submit
      </button>
    </div>
  </div>
</div>
<app-loading></app-loading>
